<!DOCTYPE html>
<html lang="{{ or site.Language.LanguageCode site.Language.Lang }}" dir="{{ or site.Language.LanguageDirection `ltr` }}">
<head>
  {{ partial "head.html" . }}
</head>
{{ $theme := "dark" }}
{{- with .Site.Params.theme }}
  {{ $theme = . }}
{{- end }}
<body
  {{- if eq $theme "dark" }}
    class="dark"
  {{- end }}
>
  <!-- <header>
    {{ partial "header.html" . }}
  </header> -->
  <main>
    {{ block "main" . }}{{ end }}
  </main>

  {{ if .Param "math" }}
    {{ partial "math.html" . }}
  {{ end }}
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
    function getSystemTheme() {
      return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }

    function applyTheme(theme) {
      document.body.classList.remove('dark', 'text-dark', 'text-light');
      if (theme === 'dark') {
        document.body.classList.add('dark', 'text-light');
      } else {
        document.body.classList.add('text-dark');
      }
      updateThemeIcon(theme);
    }

    function updateThemeIcon(theme) {
      const label = document.getElementById('theme-label');
      if (label) {
        label.textContent = theme === 'dark' ? 'dark mode' : 'light mode';
      }
    }

    function toggleTheme() {
      const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      localStorage.setItem('theme', newTheme);
      applyTheme(newTheme);
    }

    function initTheme() {
      const savedTheme = localStorage.getItem('theme');
      const theme = savedTheme || getSystemTheme();
      applyTheme(theme);
    }

    initTheme();
  </script>
</body>
</html>
